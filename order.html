<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å‚å¤åœ˜è³¼çµ±è¨ˆ</title>
<style>
  body { font-family: "Microsoft JhengHei", Arial, sans-serif; background-color: #f4f4f9; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
  .container { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); width: 100%; max-width: 400px; }
  h2 { text-align: center; color: #333; margin-bottom: 20px; }
  .form-group { margin-bottom: 15px; }
  label { display: block; margin-bottom: 5px; font-weight: bold; color: #555; }
  select, input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 16px; box-sizing: border-box; }
  input[readonly] { background-color: #e9ecef; color: #555; }
  
  /* æŒ‰éˆ•æ¨£å¼å€åŸŸ */
  .btn-group { display: flex; flex-direction: column; gap: 10px; }
  
  button { width: 100%; padding: 12px; border: none; border-radius: 5px; font-size: 16px; cursor: pointer; transition: opacity 0.3s; color: white; }
  
  /* é€å‡ºæŒ‰éˆ• (ç´…è‰²) */
  #submitBtn { background-color: #d9534f; }
  #submitBtn:hover { background-color: #c9302c; }
  #submitBtn:disabled { background-color: #ccc; cursor: not-allowed; }

  /* æŸ¥çœ‹æ˜ç´°æŒ‰éˆ• (è—è‰²) */
  #checkBtn { background-color: #5bc0de; }
  #checkBtn:hover { background-color: #31b0d5; }

  #status { margin-top: 15px; text-align: center; font-size: 14px; min-height: 20px; }
  .success { color: green; }
  .error { color: red; }
</style>
</head>
<body>

<div class="container">
  <h2>ğŸ¤« å‚å¤åœ˜è³¼ç§˜å¯†ä¸‹å–®</h2>
  <form id="orderForm">
    <div class="form-group">
      <label for="user">æˆ‘æ˜¯èª°ï¼š</label>
      <select id="user" required>
        <option value="" disabled selected>è«‹é¸æ“‡è¨‚è³¼äºº</option>
        <option value="Jane">Jane</option>
        <option value="å°å°">å°å°</option>
        <option value="æ¦´æ§¤å“¥">æ¦´æ§¤å“¥</option>
      </select>
    </div>

    <div class="form-group">
      <label for="product">è¨‚è³¼å“é …ï¼š</label>
      <select id="product" required>
        <option value="" disabled selected>è«‹é¸æ“‡å•†å“</option>
      </select>
    </div>

    <div class="form-group">
      <label for="price">å–®åƒ¹ï¼š</label>
      <input type="text" id="price" readonly placeholder="é¸æ“‡å•†å“å¾Œé¡¯ç¤º">
    </div>

    <div class="form-group">
      <label for="quantity">æ•¸é‡ï¼š</label>
      <input type="number" id="quantity" min="1" value="1" required>
    </div>

    <div class="form-group">
      <label for="total">ç¸½é‡‘é¡ï¼š</label>
      <input type="text" id="total" readonly placeholder="0">
    </div>

    <div class="btn-group">
      <button type="submit" id="submitBtn">é€å‡ºè¨‚å–®</button>
      <button type="button" id="checkBtn">ğŸ“Š æŸ¥çœ‹ç›®å‰è¨‚è³¼æ˜ç´°</button>
    </div>
    
    <div id="status"></div>
  </form>
</div>

<script>
  // å•†å“è³‡æ–™
  const products = [{"name":"ç‰¹è£½è‚‰è„¯é¬†","price":150},{"name":"[æ–°å“]éº»è¾£é­šçš®","price":100},{"name":"æµ·è‹”è‚‰é¬†","price":150},{"name":"[æ–°å“]ç³–ç²’ç´…ç‰‡","price":100},{"name":"å…’ç«¥è‚‰é¬†","price":150},{"name":"[æ–°å“]å‹è¾£é­šç‰‡","price":50},{"name":"ç´”è‚‰é¬†","price":150},{"name":"å¤æ—©å‘³ç´…ç‰‡","price":50},{"name":"è‚‰è„¯","price":150},{"name":"é±ˆé­šé¦™çµ²","price":50},{"name":"è‚‰é¬†å°è„†é¤…","price":150},{"name":"é¦™çƒ¤é­·é­šç‰‡","price":200},{"name":"æ¸¯å¼è˜¿è””ç³•","price":80},{"name":"å°ç‡’å·","price":200},{"name":"é£›å·ç‰‡","price":200},{"name":"(æ–°å“)æŸšé¦™è‚‰å¹²","price":200},{"name":"é­·é­šçµ²","price":200},{"name":"åŸå‘³ç­·å­è‚‰å¹²","price":200},{"name":"ç¢³çƒ¤çµ²","price":200},{"name":"æ³°å¼æ–¹å¡Šè‚‰å¹²","price":200},{"name":"é­·é­šç‰‡","price":200},{"name":"æ³°å¼ç­·å­è‚‰å¹²","price":200},{"name":"æ——é­šé¬†","price":150},{"name":"åŸå‘³è‚‰æ¢","price":200},{"name":"æ——é­šè„¯","price":150},{"name":"å¤§çµ²è‚‰æ¢","price":200},{"name":"æŸ´é­šä¸è§’","price":150},{"name":"è±¬è‚‰ç‰‡","price":200},{"name":"é®ªé­šä¸è§’","price":150},{"name":"éº»è¾£è±¬è‚‰ç‰‡","price":200},{"name":"é»‘èƒ¡æ¤’åˆ‡ç‰‡é±ˆé­šé¢¨å‘³","price":150},{"name":"æ²™èŒ¶è±¬è‚‰ç‰‡","price":200},{"name":"å¡”é¦™åˆ‡ç‰‡é±ˆé­šé¢¨å‘³","price":150},{"name":"è±¬è‚‰æ¢","price":200},{"name":"é­¯è‚‰åˆ‡ç‰‡é±ˆé­šé¢¨å‘³","price":150},{"name":"æª¸æª¬è±¬è‚‰æ¢","price":200},{"name":"éº»è¾£åˆ‡ç‰‡é±ˆé­šé¢¨å‘³","price":150},{"name":"é»‘èƒ¡æ¤’è±¬è‚‰æ¢","price":200},{"name":"é»‘èŠéº»é±ˆé­šé¦™çµ²","price":200},{"name":"è±¬è‚‰è§’","price":300},{"name":"é±ˆé­šé¢¨å‘³æ¢","price":100},{"name":"é»‘èƒ¡æ¤’åšè‚‰å¹²","price":200},{"name":"çƒ˜çƒ¤ç‰‡","price":100},{"name":"åŸå‘³è–„è‚‰å¹²","price":200},{"name":"é¦™ä¹‹é­š","price":100},{"name":"é»‘èƒ¡æ¤’è–„è‚‰å¹²","price":200},{"name":"æµ·è‹”é…¥ç‰‡","price":90},{"name":"åŸå‘³æä»è‚‰å¹²","price":200},{"name":"æä»é…¥ç‰‡","price":90},{"name":"é»‘èƒ¡æ¤’æä»è‚‰å¹²","price":200},{"name":"(æ–°å“)é»‘ç§ˆç³™ç±³èŠ±ç”Ÿç±³é¦™(ç´”ç´ )","price":150},{"name":"åŸå‘³æª¸æª¬è‚‰å¹²","price":200},{"name":"(æ–°å“)é­šæ± é„‰é¦™è‡(ç´”ç´ )","price":450},{"name":"è¾£å‘³æª¸æª¬è‚‰å¹²","price":200},{"name":"(æ–°å“)é­šæ± é„‰éˆ•æ‰£è‡(ç´”ç´ )","price":315},{"name":"èœœæ±è‚‰å¹²","price":200},{"name":"(æ–°å“)ç±³è„†ç‰‡(ç´”ç´ )","price":100},{"name":"äº”é¦™ç‰›è‚‰å¹²","price":300},{"name":"(æ–°å“)éº»è¾£é´¨è¡€","price":150},{"name":"é»‘èƒ¡æ¤’ç‰›è‚‰å¹²","price":300},{"name":"é¦™æ»·è›‹(è›‹å¥¶ç´ )","price":150},{"name":"ç‰›è‚‰è§’","price":300},{"name":"ç‡•éº¥è„†é¤…(å¥¶ç´ )","price":150},{"name":"ç‰›è…±æ¢","price":150},{"name":"å°é³³æ¢¨é…¥(è›‹å¥¶ç´ )","price":100},{"name":"ç‰›è…±","price":120},{"name":"é»‘ç±³ç‡’æµ·è‹”è„†ç‰‡(ç´”ç´ )","price":100},{"name":"ç´…èŒ¶é¦™ç“œå­(ç´”ç´ )","price":50},{"name":"å°ç£é’ä»é»‘è±† (ç´”ç´ )","price":50},{"name":"ç„¦ç³–é¦™ç“œå­(ç´”ç´ )","price":50},{"name":"é¦™éµè›‹ (è›‹ç´ )","price":80},{"name":"å¥¶é¦™è‘µç“œå­(å¥¶ç´ )","price":50},{"name":"èœ‚èœœä¹³é…ªçµ²(å¥¶ç´ )","price":200},{"name":"æä»å°é­šå¹²","price":100},{"name":"è¾£å‘³ä¹³é…ªçµ²(å¥¶ç´ )","price":200},{"name":"èµ·å¸è ¶è±†é…¥","price":100},{"name":"æ³¢ç¾…èœœ(ç´”ç´ )","price":100},{"name":"ç«¹ç‚­èŠ±ç”Ÿ(ç´”ç´ )","price":100},{"name":"èŠ‹é ­æ¢(ç´”ç´ )","price":100},{"name":"æ¤’éº»èŠ±ç”Ÿ(ç´”ç´ )","price":150},{"name":"ç¶œåˆè”¬æœä¹¾(ç´”ç´ )","price":100},{"name":"å‰çš®è¾£èŠ±ç”Ÿ","price":150},{"name":"ç´ é¦™é¬†(ç´”ç´ )","price":100},{"name":"é¦™é…¥è…°æœ","price":200},{"name":"ç´ è¹„ç­‹(ç´”ç´ )","price":100},{"name":"åŸå‘³è…°æœ(ç´”ç´ )","price":200},{"name":"è¾£ç´ è¹„ç­‹(ç´”ç´ )","price":100},{"name":"æ¤’éº»è±†ä¸(ç´”ç´ )","price":50},{"name":"ç´ é»‘èƒ¡æ¤’è‚‰æ¢(ç´”ç´ )","price":150},{"name":"é¦™è’œç²„æ¢","price":100},{"name":"ç´ èœœæ±è‚‰å¹²(ç´”ç´ )","price":150},{"name":"æ²™èŒ¶è±†å¹²","price":100},{"name":"ç´ é¦™è‡ç´ è¹„(å¥¶ç´ )","price":150},{"name":"è’œç‰‡è±†å¹²","price":100},{"name":"äº”é¦™è’Ÿè’»å¹²(ç´”ç´ )","price":150},{"name":"[è¾£]é¹¹é…¥é›é¢¨å‘³è±†å¹²(ç´”ç´ )","price":100},{"name":"åŒ–æ ¸æ","price":100},{"name":"Qå¿ƒè±†å¹²(ç´”ç´ )","price":100},{"name":"ç¶œåˆæ¢…","price":50},{"name":"é»‘è±†å¹²(ç´”ç´ )","price":100},{"name":"åŸå‘³æ¢…ç‰‡","price":50},{"name":"é¦™Qæ¢è±†å¹²(ç´”ç´ )","price":100},{"name":"æª¸æª¬æœä¹¾","price":50},{"name":"æ²™èŒ¶è¾£è±†å¹²(ç´”ç´ )","price":100},{"name":"ä»™æ¥‚é¤…","price":50},{"name":"é»ƒé‡‘æ¢è¾£è±†å¹²(ç´”ç´ )","price":100},{"name":"è˜‹æœæœä¹¾","price":100},{"name":"ç´…è—œéº¥(ç´”ç´ )","price":190},{"name":"ä¸€å£æ¢…è‚‰","price":100},{"name":"æ¿•ç´™å·¾ï¼ˆ10æŠ½ï¼‰","price":15},{"name":"å°ç£è„†æ¢…","price":100},{"name":"[æ–°å“]éº¥èŒ¶èŒ¶åŒ…","price":150},{"name":"æœå¯¦æ„ŸèŠ’æœä¹¾","price":100},{"name":"å‡é ‚çƒé¾èŒ¶èŒ¶åŒ…","price":150},{"name":"è•ƒèŒ„æœä¹¾","price":100},{"name":"å°è‘‰ç´…ç´…èŒ¶èŒ¶åŒ…","price":150},{"name":"é³³æ¢¨æœä¹¾","price":100},{"name":"è‰è“æœä¹¾","price":100},{"name":"é¦™æ©™ç‰‡","price":100},{"name":"ç´…è–‘é»ƒæ©„æ¬–","price":100},{"name":"é»ƒè‰æ©„æ¬–","price":100},{"name":"ç”˜ç”œæ¢…","price":100},{"name":"è‘¡è„ä¹¾","price":100},{"name":"æ¢…ç²‰è‘¡è„ä¹¾","price":100},{"name":"èŠ­æ¨‚ä¹¾","price":100},{"name":"å“ˆå¯†ç“œä¹¾","price":120},{"name":"è”“è¶Šè“ä¹¾","price":150},{"name":"èŠ’æœä¹¾","price":150},{"name":"é‡ç”Ÿè—è“ä¹¾","price":150},{"name":"æ„›æ–‡èŠ’æœä¹¾","price":200},{"name":"ä¹¾æ‹Œéºµ-é…¢é†¬","price":40},{"name":"ä¹¾æ‹Œéºµ-å››å·æ¤’éº»","price":40},{"name":"ä¹¾æ‹Œéºµ-éº»è¾£é†¬é¦™","price":40},{"name":"è‚¯äºæ¿¾æ›å¼å’–å•¡","price":200},{"name":"è˜‡é–€ç­”è‡˜æ¿¾æ›å¼å’–å•¡","price":200},{"name":"(æ–°å“)é›æ±é’è”¥æ²æ²é¤…","price":50},{"name":"è€¶åŠ é›ªè²-å’–å•¡è±†","price":250},{"name":"(æ–°å“)è’œå‘³è„†è²é¤…","price":50},{"name":"æ—©é¤é…æ–¹-å’–å•¡è±†","price":170},{"name":"(æ–°å“)è¾£å‘³èµ·å¸æ´‹èŠ‹ç‰‡","price":50},{"name":"å·´è¥¿å˜‰å¹´è¯-å’–å•¡è±†","price":200},{"name":"(æ–°å“)æ¤’é¦™ç‰ç±³çƒ","price":50},{"name":"æ›¼ç‰¹å¯§-å’–å•¡è±†","price":250},{"name":"èµ·å¸çˆ†ç±³èŠ±-åˆ†äº«æ¡¶","price":150},{"name":"æ¥µè‡´è€é¥•-å’–å•¡è±†","price":180},{"name":"å¯å¯ç±³è“","price":110},{"name":"å¤å‰ç½•è²æ‹‰-å’–å•¡è±†","price":300},{"name":"æµ·è‹”çˆ†ç±³èŠ±ä»™è²","price":100},{"name":"å¸ƒæœ—å°¼è„†é¤…","price":100},{"name":"èŠ±ç”Ÿé¦™Qé¤…","price":100},{"name":"(æ–°å“)é»‘èŠéº»ç‰›è»‹ç³–ã€è›‹å¥¶ç´ ã€‘","price":100},{"name":"é»‘ç³–é¦™Qé¤…","price":100},{"name":"èŠéº»æ ¸æ¡ƒç³•ã€ç´”ç´ ã€‘","price":100},{"name":"éº»è¾£æ²¹æ¢","price":90},{"name":"é»ƒé‡‘èŠ’æœç‰›è»‹ç³–ã€å¥¶ç´ ã€‘","price":130},{"name":"é­šè–¯æ¢","price":55},{"name":"åŸå‘³ç±³ç‰›è»‹ç³–ã€å¥¶ç´ ã€‘","price":250},{"name":"èšµä»”é…¥-é¹¹è›‹é»ƒ","price":55},{"name":"å— æ£— æ ¸ æ¡ƒ ç³•ã€ç´”ç´ ã€‘","price":270},{"name":"èµ·å¸-ä¸‰è§’è„†è–¯","price":50},{"name":"æ¤’é¹½è±†è…é¤…ä¹¾","price":80},{"name":"æµ·è‹”-ä¸‰è§’è„†è–¯","price":50},{"name":"[æ–°å“]å°å¼çƒ¤æµ·è‹”-åŸå‘³-ç´”ç´ ","price":50},{"name":"æµ·è‹”è¦åœˆåœˆ","price":50},{"name":"[æ–°å“]èŠéº»è•¨é¤…(ç´”ç´ )","price":50},{"name":"å·è¾£è¦æ¢","price":50},{"name":"[æ–°å“]æ¤°é¦™ç´…è±†ä¸²ç³°å­(ç´”ç´ )","price":50},{"name":"ç”˜æ¢…é¢¨å‘³è–¯æ¢","price":50},{"name":"(æ–°å“)æ±½æ°´é¢¨å‘³è·³è·³æ£‰èŠ±ç³–","price":35},{"name":"é¦™è¾£å°è–¯æ¢","price":50},{"name":"(æ–°å“)é¹½å‘³è–¯æ¢","price":100},{"name":"ç•ªè–¯ç‰‡","price":50},{"name":"(æ–°å“)è”æå‘³è’Ÿè’»å‡","price":50},{"name":"èµ·å¸è±†è„†ç‰‡","price":50},{"name":"ç„¦ç³–çˆ†ç±³èŠ±-åˆ†äº«æ¡¶","price":150},{"name":"å¡å“©æ£’-ç”°åœ’é¦™è”¥","price":50},{"name":"å¯å¯çˆ†ç±³èŠ±-åˆ†äº«æ¡¶","price":150},{"name":"é¦™è„†è±Œè±†","price":50},{"name":"èŠ±ç”Ÿç²©","price":100},{"name":"è¦ä¹‹è„†","price":50},{"name":"ç¶œ        åˆ       èŠ     éº»     çƒ","price":100},{"name":"è¦    é¤…","price":50},{"name":"é»‘èŠéº»è²¢ç³–","price":100},{"name":"è’œè¾£è¦é¤…","price":50},{"name":"èŠ±ç”Ÿè²¢ç³–","price":100},{"name":"ç‰ç±³æ¢","price":50},{"name":"å°å¼çƒ¤æµ·è‹”-æ¤’é¹½å£å‘³","price":50},{"name":"è’œé¦™åœŸå¸","price":50},{"name":"å°å¼çƒ¤æµ·è‹”-ç´ è¾£å£å‘³","price":50},{"name":"é‡‘ç‰ç±³","price":50},{"name":"çƒæ¢…è»Ÿç³–","price":50},{"name":"çœŸé­·å‘³","price":50},{"name":"è–‘æ¯è»Ÿç³–","price":50},{"name":"é¹¹è”¬é¤…","price":50},{"name":"æµ·è‹”ä»™è²","price":50},{"name":"å°æœˆäº®é¤…","price":50},{"name":"æµ·è‹”ç±³æœ","price":50},{"name":"èšµä»”ç…é¢¨å‘³æ´‹èŠ‹ç‰‡","price":50},{"name":"è€³æœµé¤…","price":50},{"name":"è¾›è¾£æ´‹èŠ‹ç‰‡","price":50},{"name":"å“ˆå£«æ¢","price":50},{"name":"çƒ¤é›æ´‹èŠ‹ç‰‡","price":50},{"name":"å¡å“©å¡å“©-ç”œå‘³","price":50},{"name":"é…¸è¾£æ´‹èŠ‹æ²","price":50},{"name":"ç«ç‘°é¹½æ´‹èŠ‹ç‰‡","price":50},{"name":"æ´‹èŠ‹çƒ","price":50},{"name":"æµ·è‹”æ´‹èŠ‹ç‰‡","price":50},{"name":"æµ·è‹”é¬†é¤…","price":50},{"name":"æ´‹èŠ‹åœˆ","price":50},{"name":"èŠ¥èŒ‰é¬†é¤…","price":50},{"name":"å°éº»æ¢","price":50},{"name":"é»‘èƒ¡æ¤’é¬†é¤…","price":50},{"name":"æœå‡æ¢","price":50},{"name":"æ¼¢å ¡ç³–","price":50},{"name":"(æ–°å“)èœ‚èœœå°ç…é¤…","price":150},{"name":"æ£‰èŠ±ç³–","price":50},{"name":"(æ–°å“)èµ·å¸é¢¨å‘³è›‹æ²","price":100},{"name":"åŒ…é¤¡æ£‰èŠ±ç³–","price":50},{"name":"æä»é¤…","price":150},{"name":"æ°´æœè»Ÿç³–","price":50},{"name":"å¯å¯è„†é¤…","price":100},{"name":"(æ–°å“)ç„¦ç³–ç”œç”œåœˆ","price":50},{"name":"æ¾éœ²æ–¹å¡Šé…¥","price":100},{"name":"(æ–°å“)è‰è“å„ªæ ¼é¢¨å‘³ç±³é¤…","price":50},{"name":"èŠéº»æ»´è›‹æ²","price":100},{"name":"ç›Šç”ŸèŒè’Ÿè’»å‡","price":50},{"name":"é¹¹è›‹é»ƒé…¥æ£’","price":50},{"name":"æµ·è‹”é¹½è˜‡æ‰“é¤…","price":50},{"name":"ç³™ç±³ç‰›å¥¶æ£’","price":50},{"name":"èœ‚èœœæª¸æª¬éº¥èŠ½é¤…","price":50},{"name":"é‡‘æ²™è›‹é»ƒéº¥èŠ½é¤…","price":50},{"name":"é»‘ç³–éº¥èŠ½é¤…","price":50},{"name":"æ¡ƒã€€ã€€ã€€é…¥","price":50},{"name":"é®®å¥¶éª¨é¤…","price":50},{"name":"ä¹³é¦™å¥¶é…¥","price":50},{"name":"æ˜Ÿå½¢å·§å…‹åŠ›é¢¨å‘³ç±³é¤…","price":50},{"name":"å°é¥…é ­é¤…ä¹¾","price":50},{"name":"é…¥ç³–åœŸå¸","price":50},{"name":"å¡å“©å¡å“©-é¹¹è›‹é»ƒ","price":50},{"name":"å·§å…‹åŠ›é¢¨å‘³ç”œç”œåœˆ","price":50},{"name":"é»‘ç³–æ²™çªç‘ª","price":50},{"name":"ç‰›å¥¶ç”œç”œåœˆ","price":50},{"name":"èŠ‹é ­ç‰›å¥¶è„†æ²","price":50},{"name":"å¡å“©å¡å“©-æµ·è‹”","price":50},{"name":"è‰è“æ²å¿ƒé¤…","price":50},{"name":"æ•¸å­—é¤…","price":50},{"name":"å¥¶æ²¹é¢¨å‘³æ²å¿ƒé¤…","price":50},{"name":"é£›æ©Ÿé¤…","price":50},{"name":"æ ¼å­ç…é¤…","price":50},{"name":"èœè„¯é¢¨å‘³é¤…","price":50},{"name":"æµ·è‹”ç…é¤…","price":50},{"name":"å¯å¯æ²å¿ƒé…¥","price":50},{"name":"é»‘èŠéº»ç…é¤…","price":50},{"name":"å’–å•¡æ²å¿ƒé…¥","price":50}];

  // ğŸ”´ è«‹åœ¨é€™è£¡å¡«å…¥ä½ çš„ Google Script ç¶²å€ ğŸ”´
  const scriptURL = 'https://script.google.com/macros/s/AKfycbwfYe_UsgIDwhxgZbCn_cqReK_Pmr0WIYgzjkWzeqDiDiW207j3uTe1LhEj7O9FXmEG/exec'; 
  
  // ğŸ”µ è«‹åœ¨é€™è£¡å¡«å…¥ä½ çš„ Google Sheet è©¦ç®—è¡¨é€£çµ (è¨˜å¾—è¦é–‹æ¬Šé™çµ¦çŸ¥é“é€£çµçš„äºº) ğŸ”µ
  const sheetURL = 'https://docs.google.com/spreadsheets/d/11CtFqrLgr-ef2QWkZ59Ign-_AN-O_XtUZ_aD9zTU2O0/edit?gid=0#gid=0';

  const productSelect = document.getElementById('product');
  const priceInput = document.getElementById('price');
  const quantityInput = document.getElementById('quantity');
  const totalInput = document.getElementById('total');
  const form = document.getElementById('orderForm');
  const statusDiv = document.getElementById('status');
  const submitBtn = document.getElementById('submitBtn');
  const checkBtn = document.getElementById('checkBtn');

  // åˆå§‹åŒ–å•†å“ä¸‹æ‹‰é¸å–®
  products.forEach(p => {
    const option = document.createElement('option');
    option.value = p.name;
    option.textContent = p.name;
    option.dataset.price = p.price;
    productSelect.appendChild(option);
  });

  // æ›´æ–°åƒ¹æ ¼èˆ‡ç¸½é‡‘é¡
  function updateCalc() {
    const selectedOption = productSelect.options[productSelect.selectedIndex];
    const price = selectedOption.dataset.price ? parseInt(selectedOption.dataset.price) : 0;
    const quantity = parseInt(quantityInput.value) || 0;
    
    priceInput.value = price;
    totalInput.value = price * quantity;
  }

  productSelect.addEventListener('change', updateCalc);
  quantityInput.addEventListener('input', updateCalc);

  // æŸ¥çœ‹è¨‚è³¼æ˜ç´°æŒ‰éˆ•äº‹ä»¶
  checkBtn.addEventListener('click', () => {
    if(!sheetURL || sheetURL.includes("ä½ çš„_GOOGLE_SHEET_é€£çµ")) {
        alert("è«‹å…ˆåœ¨ HTML ç¨‹å¼ç¢¼ä¸­è¨­å®š Google Sheet é€£çµï¼");
    } else {
        window.open(sheetURL, '_blank');
    }
  });

  // é€å‡ºè¡¨å–®
  form.addEventListener('submit', e => {
    e.preventDefault();
    
    if(!scriptURL || scriptURL.includes("ä½ çš„_GOOGLE_SCRIPT_ç¶²å€")) {
      alert("è«‹å…ˆåœ¨ HTML ç¨‹å¼ç¢¼ä¸­è¨­å®š Google Script ç¶²å€ï¼");
      return;
    }

    submitBtn.disabled = true;
    statusDiv.textContent = "è³‡æ–™å‚³é€ä¸­...";
    statusDiv.className = "";

    const data = {
      user: document.getElementById('user').value,
      product: productSelect.value,
      price: priceInput.value,
      quantity: quantityInput.value,
      total: totalInput.value
    };

    fetch(scriptURL, {
      method: 'POST',
      mode: 'no-cors',
      headers: {
        'Content-Type': 'text/plain'
      },
      body: JSON.stringify(data)
    })
    .then(response => {
      statusDiv.textContent = "âœ… è¨‚å–®å·²é€å‡ºï¼";
      statusDiv.className = "success";
      form.reset();
      updateCalc(); 
      setTimeout(() => { 
        submitBtn.disabled = false; 
        statusDiv.textContent = "";
      }, 3000);
    })
    .catch(error => {
      console.error('Error:', error);
      statusDiv.textContent = "âŒ é€£ç·šéŒ¯èª¤ï¼Œè«‹æª¢æŸ¥ç¶²å€æˆ–ç¶²è·¯ã€‚";
      statusDiv.className = "error";
      submitBtn.disabled = false;
    });
  });
</script>

</body>
</html>